<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audit de besoins — Community Management - PuyDeCom Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="icon" href="https://puydecom.fr/images/Logo-Puy-De-Com.jpeg">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'puy-orange': '#10B981',
                        'puy-red': '#059669',
                        'puy-blue': '#1E40AF',
                        'puy-action': '#10B981'
                    },
                    fontFamily: {
                        'inter': ['Inter', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        :root {
            --puy-orange: #10B981;
            --puy-red: #059669;
            --puy-dark: #1F2937;
            --puy-light: #34D399;
            --puy-action: #10B981;
        }
        
        .bg-puy-action { background-color: var(--puy-action); }
        .text-puy-action { color: var(--puy-action); }
        
        /* Wizard specific styles */
        .step-content {
            animation: fadeIn 0.3s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Focus styles for accessibility */
        input:focus, select:focus, textarea:focus {
            outline: none;
            ring-width: 2px;
            ring-color: #10B981;
            border-color: transparent;
        }
        
        /* Mobile responsive adjustments */
        @media (max-width: 640px) {
            .progress-step-label {
                display: none;
            }
            
            .wizard-navigation {
                flex-direction: column-reverse;
                gap: 0.5rem;
            }
        }
        
        /* Progress bar responsive */
        @media (max-width: 768px) {
            .progress-bar-container {
                padding: 1rem;
            }
        }
        
        .step-content {
            display: none;
        }
        
        .step-content.active {
            display: block;
        }
        
        @media print {
            body { 
                font-size: 11pt; 
                font-family: 'Inter', 'Arial', sans-serif;
                line-height: 1.4;
                color: #333;
            }
            .print-header { display: block !important; }
            .no-print { display: none !important; }
            .step-content { display: block !important; }
            .bg-white { background: white !important; }
            .shadow-lg, .shadow-xl { box-shadow: none !important; }
            
            /* Page de couverture */
            .cover-page {
                page-break-after: always;
                height: 100vh;
                display: flex;
                flex-direction: column;
                justify-content: center;
                text-align: center;
                padding: 2cm;
            }
            
            /* Table des matières */
            .toc-page {
                page-break-before: always;
                page-break-after: always;
            }
            
            .toc-item {
                display: flex;
                justify-content: space-between;
                padding: 0.3rem 0;
                border-bottom: 1px dotted #ccc;
                margin-bottom: 0.2rem;
            }
            
            /* Chapitres */
            .chapter {
                page-break-before: always;
                margin-bottom: 2rem;
            }
            
            .chapter:first-child {
                page-break-before: auto;
            }
            
            .chapter-title {
                font-size: 18pt;
                font-weight: bold;
                color: #1F2937;
                margin-bottom: 1rem;
                padding-bottom: 0.5rem;
                border-bottom: 2px solid #10B981;
            }
            
            .chapter-number {
                color: #10B981;
                margin-right: 0.5rem;
            }
            
            /* Sections */
            .section {
                margin-bottom: 1.5rem;
            }
            
            .section-title {
                font-size: 14pt;
                font-weight: 600;
                color: #374151;
                margin-bottom: 0.8rem;
            }
            
            .section-content {
                margin-left: 1rem;
                margin-bottom: 1rem;
            }
            
            /* Tableaux */
            .print-table {
                width: 100%;
                border-collapse: collapse;
                margin: 1rem 0;
                font-size: 10pt;
            }
            
            .print-table th,
            .print-table td {
                border: 1px solid #ddd;
                padding: 0.5rem;
                text-align: left;
            }
            
            .print-table th {
                background-color: #f8f9fa;
                font-weight: 600;
            }
            
            /* Éviter les coupures */
            .avoid-break {
                page-break-inside: avoid;
            }
            
            /* Headers et footers */
            @page {
                margin: 2.5cm 2cm;
                @top-center {
                    content: "Audit Community Management";
                    font-size: 9pt;
                    color: #666;
                }
                @bottom-center {
                    content: "Page " counter(page);
                    font-size: 9pt;
                    color: #666;
                }
                @bottom-right {
                    content: "PuyDeCom";
                    font-size: 9pt;
                    color: #666;
                }
            }
            
            /* Page de couverture sans header/footer */
            @page:first {
                @top-center { content: none; }
                @bottom-center { content: none; }
                @bottom-right { content: none; }
            }
            
            /* Signatures */
            .signatures-print {
                page-break-before: always;
                margin-top: 2rem;
            }
            
            .signature-box {
                border: 1px solid #ddd;
                padding: 1rem;
                margin: 1rem 0;
            }
            
            /* Listes */
            ul, ol {
                margin: 0.5rem 0;
                padding-left: 1.5rem;
            }
            
            li {
                margin-bottom: 0.3rem;
            }
        }
        
        .print-header {
            display: none;
            page-break-after: avoid;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-50 to-gray-100 min-h-screen font-inter">
    
    <!-- Navigation moderne -->
    <nav class="bg-white/80 backdrop-blur-md shadow-lg border-b border-gray-200/50 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center space-x-3">
                        <img src="https://puydecom.fr/images/Logo-Puy-De-Com.jpeg" alt="PuyDeCom" class="w-10 h-10 rounded-lg shadow-sm">
                        <div>
                            <h1 class="text-xl font-bold text-gray-900">PuyDeCom</h1>
                            <p class="text-xs text-gray-500">Admin Dashboard</p>
                        </div>
                    </div>
                </div>
                
                <!-- Actions droite -->
                <div class="flex items-center space-x-4">
                    <a href="./analyse360.html" class="text-puy-action hover:bg-gray-100 px-4 py-2 rounded-lg text-sm font-medium flex items-center space-x-2 transition-colors">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
                        </svg>
                        <span>Retour</span>
                    </a>
                    <button id="logoutButton" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center space-x-2 transition-colors shadow-lg">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                        </svg>
                        <span class="hidden md:inline">Déconnexion</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Contenu principal -->
    <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Breadcrumb -->
        <nav class="flex mb-6" aria-label="Breadcrumb">
            <ol class="flex items-center space-x-4">
                <li>
                    <a href="./analyse360.html" class="text-gray-500 hover:text-gray-700 transition-colors">
                        Analyse 360°
                    </a>
                </li>
                <li>
                    <svg class="w-4 h-4 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
                    </svg>
                </li>
                <li>
                    <span class="text-gray-900 font-medium" aria-current="page">Audit Community Management</span>
                </li>
            </ol>
        </nav>

        <!-- En-tête -->
        <header class="mb-8">
            <div class="flex items-center space-x-4 mb-4">
                <div class="p-3 bg-green-100 rounded-xl">
                    <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a3 3 0 01-3-3V6a3 3 0 013-3h6a3 3 0 013 3v2z"/>
                    </svg>
                </div>
                <div>
                    <h1 class="text-3xl font-bold text-gray-900">Audit de besoins — Community Management</h1>
                    <p class="text-lg text-gray-600 mt-1">Questionnaire complet pour évaluer vos besoins en community management</p>
                </div>
            </div>
        </header>
        <div class="space-y-8">
            
            <!-- Print Header -->
            <div class="print-header">
                <div class="flex justify-between items-start mb-8">
                    <div class="flex items-center space-x-4">
                        <img src="https://puydecom.fr/images/Logo-Puy-De-Com.jpeg" alt="PuyDeCom" class="w-16 h-16 rounded-lg">
                        <div>
                            <h1 class="text-3xl font-bold text-gray-900">Audit Community Management</h1>
                            <p class="text-lg text-gray-600 mt-1">PuyDeCom - Analyse 360</p>
                            <p class="text-sm text-gray-500 mt-1">Généré le: <span id="printDate"></span></p>
                        </div>
                    </div>
                </div>
                
                <!-- Zones de signature en bas du PDF -->
                <div class="signatures-section" style="page-break-before: always; margin-top: 50px;">
                    <h2 class="text-xl font-bold text-gray-900 mb-6">Signatures</h2>
                    <div class="grid grid-cols-2 gap-8">
                        <div class="signature-box">
                            <div class="border-b-2 border-gray-400 pb-2 mb-2 h-20"></div>
                            <div class="text-center">
                                <p class="font-semibold">Client</p>
                                <p class="text-sm text-gray-600">Nom et signature</p>
                                <p class="text-sm text-gray-600 mt-2">Date: ___________</p>
                            </div>
                        </div>
                        <div class="signature-box">
                            <div class="border-b-2 border-gray-400 pb-2 mb-2 h-20"></div>
                            <div class="text-center">
                                <p class="font-semibold">PuyDeCom</p>
                                <p class="text-sm text-gray-600">Nom et signature</p>
                                <p class="text-sm text-gray-600 mt-2">Date: ___________</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Stepper -->
            <div class="bg-white rounded-lg shadow-lg p-6 no-print">
                <div class="flex items-center justify-between mb-6">
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center">
                            <div class="flex items-center space-x-2">
                                <div id="stepIndicator" class="w-8 h-8 bg-puy-orange text-white rounded-full flex items-center justify-center text-sm font-bold">1</div>
                                <span id="stepTitle" class="text-lg font-semibold text-gray-900">Informations générales</span>
                            </div>
                            <div class="ml-4 text-sm text-gray-500">
                                Étape <span id="currentStep">1</span> sur 8
                            </div>
                        </div>
                    </div>
                    <div class="flex space-x-2">
                        <button id="prevButton" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors disabled:opacity-50" disabled>Précédent</button>
                        <button id="nextButton" class="px-4 py-2 bg-puy-orange text-white rounded-md hover:bg-puy-red transition-colors">Suivant</button>
                    </div>
                </div>
                
                <!-- Progress bar -->
                <div class="w-full bg-gray-200 rounded-full h-2 mb-6">
                    <div id="progressBar" class="bg-puy-orange h-2 rounded-full transition-all duration-300" style="width: 12.5%"></div>
                </div>
            </div>

            <!-- Steps Content -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <!-- Étape 1: Informations générales -->
                <div class="step-content active" data-step="1">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">1. Informations générales</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="entreprise" class="block text-sm font-medium text-gray-700">Nom de l'entreprise</label>
                            <input type="text" id="entreprise" placeholder="Raison sociale" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                        </div>
                        <div>
                            <label for="secteur" class="block text-sm font-medium text-gray-700">Secteur d'activité</label>
                            <input type="text" id="secteur" placeholder="Votre secteur" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                        </div>
                        <div>
                            <label for="nomPrenom" class="block text-sm font-medium text-gray-700">Nom et prénom</label>
                            <input type="text" id="nomPrenom" placeholder="Contact principal" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                        </div>
                        <div>
                            <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
                            <input type="email" id="email" placeholder="votre@email.com" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                        </div>
                        <div>
                            <label for="telephone" class="block text-sm font-medium text-gray-700">Téléphone</label>
                            <input type="tel" id="telephone" placeholder="Numéro de téléphone" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                        </div>
                        <div>
                            <label for="tailleEntreprise" class="block text-sm font-medium text-gray-700">Taille de l'entreprise</label>
                            <select id="tailleEntreprise" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                                <option value="">Sélectionnez</option>
                                <option value="tpe">TPE (1-9 salariés)</option>
                                <option value="pme">PME (10-249 salariés)</option>
                                <option value="eti">ETI (250-4999 salariés)</option>
                                <option value="ge">Grande entreprise (+5000 salariés)</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Commentaire d'étape -->
                    <div class="mt-6 border-t pt-4">
                        <div class="flex items-center justify-between mb-2">
                            <label for="commentaireInformationsGenerales" class="block text-sm font-medium text-gray-700">Commentaire</label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="requireCommentInformationsGenerales" class="h-4 w-4 text-puy-orange rounded border-gray-300">
                                <span class="text-sm text-gray-600">Commentaire requis</span>
                            </label>
                        </div>
                        <textarea id="commentaireInformationsGenerales" rows="3" placeholder="Notes sur les informations générales..." class="block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm"></textarea>
                        <div id="errorInformationsGenerales" class="hidden mt-2 text-sm text-red-600"></div>
                    </div>
                </div>

                <!-- Étape 2: Présence digitale actuelle -->
                <div class="step-content" data-step="2">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">2. Présence digitale actuelle</h3>
                    <div class="space-y-4">
                        <div>
                            <label for="siteWeb" class="block text-sm font-medium text-gray-700">URL de votre site web</label>
                            <input type="url" id="siteWeb" placeholder="https://votre-site.com" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Réseaux sociaux actuels</label>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                                <label class="flex items-center">
                                    <input type="checkbox" id="facebook" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Facebook</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="instagram" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Instagram</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="linkedin" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">LinkedIn</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="twitter" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Twitter/X</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="tiktok" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">TikTok</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="youtube" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">YouTube</span>
                                </label>
                            </div>
                        </div>

                        <div>
                            <label for="frequencePublication" class="block text-sm font-medium text-gray-700">Fréquence de publication actuelle</label>
                            <select id="frequencePublication" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                                <option value="">Sélectionnez</option>
                                <option value="quotidien">Quotidienne</option>
                                <option value="hebdomadaire">Hebdomadaire</option>
                                <option value="mensuel">Mensuelle</option>
                                <option value="occasionnel">Occasionnelle</option>
                                <option value="jamais">Jamais</option>
                            </select>
                        </div>

                        <div>
                            <label for="gestionActuelle" class="block text-sm font-medium text-gray-700">Qui gère actuellement vos réseaux sociaux ?</label>
                            <textarea id="gestionActuelle" rows="3" placeholder="En interne, agence externe, personne..." class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm"></textarea>
                        </div>
                    </div>
                    
                    <!-- Commentaire d'étape -->
                    <div class="mt-6 border-t pt-4">
                        <div class="flex items-center justify-between mb-2">
                            <label for="commentairePresenceDigitale" class="block text-sm font-medium text-gray-700">Commentaire</label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="requireCommentPresenceDigitale" class="h-4 w-4 text-puy-orange rounded border-gray-300">
                                <span class="text-sm text-gray-600">Commentaire requis</span>
                            </label>
                        </div>
                        <textarea id="commentairePresenceDigitale" rows="3" placeholder="Notes sur la présence digitale actuelle..." class="block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm"></textarea>
                        <div id="errorPresenceDigitale" class="hidden mt-2 text-sm text-red-600"></div>
                    </div>
                </div>

                <!-- Étape 3: Objectifs et cibles -->
                <div class="step-content" data-step="3">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">3. Objectifs et cibles</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Quels sont vos principaux objectifs ?</label>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="checkbox" id="notoriete" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Augmenter la notoriété</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="engagement" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Améliorer l'engagement</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="ventes" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Générer des ventes</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="leads" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Générer des leads</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="trafic" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Augmenter le trafic web</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="fidelisation" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Fidéliser la clientèle</span>
                                </label>
                            </div>
                        </div>

                        <div>
                            <label for="cibleAge" class="block text-sm font-medium text-gray-700">Tranche d'âge de votre cible</label>
                            <select id="cibleAge" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                                <option value="">Sélectionnez</option>
                                <option value="18-25">18-25 ans</option>
                                <option value="25-35">25-35 ans</option>
                                <option value="35-45">35-45 ans</option>
                                <option value="45-55">45-55 ans</option>
                                <option value="55+">55+ ans</option>
                                <option value="mixte">Mixte</option>
                            </select>
                        </div>

                        <div>
                            <label for="cibleDescription" class="block text-sm font-medium text-gray-700">Décrivez votre clientèle cible</label>
                            <textarea id="cibleDescription" rows="3" placeholder="Professions, centres d'intérêt, comportements..." class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm"></textarea>
                        </div>

                        <div>
                            <label for="concurrents" class="block text-sm font-medium text-gray-700">Principaux concurrents sur les réseaux sociaux</label>
                            <textarea id="concurrents" rows="3" placeholder="Noms d'entreprises concurrentes actives sur les réseaux" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm"></textarea>
                        </div>
                    </div>
                    
                    <!-- Commentaire d'étape -->
                    <div class="mt-6 border-t pt-4">
                        <div class="flex items-center justify-between mb-2">
                            <label for="commentaireObjectifsCibles" class="block text-sm font-medium text-gray-700">Commentaire</label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="requireCommentObjectifsCibles" class="h-4 w-4 text-puy-orange rounded border-gray-300">
                                <span class="text-sm text-gray-600">Commentaire requis</span>
                            </label>
                        </div>
                        <textarea id="commentaireObjectifsCibles" rows="3" placeholder="Notes sur les objectifs et cibles..." class="block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm"></textarea>
                        <div id="errorObjectifsCibles" class="hidden mt-2 text-sm text-red-600"></div>
                    </div>
                </div>

                <!-- Étape 4: Stratégie de contenu -->
                <div class="step-content" data-step="4">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">4. Stratégie de contenu</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Types de contenus souhaités</label>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="checkbox" id="photos" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Photos de produits/services</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="videos" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Vidéos</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="articles" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Articles de blog</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="temoignages" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Témoignages clients</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="promotions" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Promotions et offres</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="evenements" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Événements</span>
                                </label>
                            </div>
                        </div>

                        <div>
                            <label for="tonalite" class="block text-sm font-medium text-gray-700">Tonalité souhaitée</label>
                            <select id="tonalite" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                                <option value="">Sélectionnez</option>
                                <option value="professionnelle">Professionnelle</option>
                                <option value="decontractee">Décontractée</option>
                                <option value="humoristique">Humoristique</option>
                                <option value="inspirante">Inspirante</option>
                                <option value="educative">Éducative</option>
                            </select>
                        </div>

                        <div>
                            <label for="sujetsInterets" class="block text-sm font-medium text-gray-700">Sujets d'intérêt à aborder</label>
                            <textarea id="sujetsInterets" rows="3" placeholder="Tendances sectorielles, conseils, actualités..." class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm"></textarea>
                        </div>

                        <div>
                            <label for="ressourcesContenu" class="block text-sm font-medium text-gray-700">Ressources disponibles pour la création de contenu</label>
                            <textarea id="ressourcesContenu" rows="3" placeholder="Photos existantes, vidéos, équipe disponible..." class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm"></textarea>
                        </div>
                    </div>
                    
                    <!-- Commentaire d'étape -->
                    <div class="mt-6 border-t pt-4">
                        <div class="flex items-center justify-between mb-2">
                            <label for="commentaireStrategieContenu" class="block text-sm font-medium text-gray-700">Commentaire</label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="requireCommentStrategieContenu" class="h-4 w-4 text-puy-orange rounded border-gray-300">
                                <span class="text-sm text-gray-600">Commentaire requis</span>
                            </label>
                        </div>
                        <textarea id="commentaireStrategieContenu" rows="3" placeholder="Notes sur la stratégie de contenu..." class="block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm"></textarea>
                        <div id="errorStrategieContenu" class="hidden mt-2 text-sm text-red-600"></div>
                    </div>
                </div>

                <!-- Étape 5: Engagement et animation -->
                <div class="step-content" data-step="5">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">5. Engagement et animation</h3>
                    <div class="space-y-4">
                        <div>
                            <label for="frequenceSouhaitee" class="block text-sm font-medium text-gray-700">Fréquence de publication souhaitée</label>
                            <select id="frequenceSouhaitee" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                                <option value="">Sélectionnez</option>
                                <option value="plusieurs-jour">Plusieurs fois par jour</option>
                                <option value="quotidien">1 fois par jour</option>
                                <option value="3-semaine">3 fois par semaine</option>
                                <option value="hebdomadaire">1 fois par semaine</option>
                                <option value="bi-hebdomadaire">2 fois par mois</option>
                                <option value="mensuel">1 fois par mois</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Services d'animation souhaités</label>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="checkbox" id="reponseCommentaires" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Réponse aux commentaires</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="reponseMessages" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Réponse aux messages privés</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="moderation" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Modération</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="concours" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Organisation de concours</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="stories" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Gestion des stories</span>
                                </label>
                            </div>
                        </div>

                        <div>
                            <label for="heuresPublication" class="block text-sm font-medium text-gray-700">Heures de publication préférées</label>
                            <input type="text" id="heuresPublication" placeholder="Ex: 9h, 12h, 18h" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                        </div>

                        <div>
                            <label for="gestionCrise" class="block text-sm font-medium text-gray-700">Comment gérer les commentaires négatifs ?</label>
                            <textarea id="gestionCrise" rows="3" placeholder="Votre approche face aux critiques" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm"></textarea>
                        </div>
                    </div>
                    
                    <!-- Commentaire d'étape -->
                    <div class="mt-6 border-t pt-4">
                        <div class="flex items-center justify-between mb-2">
                            <label for="commentaireEngagementAnimation" class="block text-sm font-medium text-gray-700">Commentaire</label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="requireCommentEngagementAnimation" class="h-4 w-4 text-puy-orange rounded border-gray-300">
                                <span class="text-sm text-gray-600">Commentaire requis</span>
                            </label>
                        </div>
                        <textarea id="commentaireEngagementAnimation" rows="3" placeholder="Notes sur l'engagement et animation..." class="block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm"></textarea>
                        <div id="errorEngagementAnimation" class="hidden mt-2 text-sm text-red-600"></div>
                    </div>
                </div>

                <!-- Étape 6: Budget et ressources -->
                <div class="step-content" data-step="6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">6. Budget et ressources</h3>
                    <div class="space-y-4">
                        <div>
                            <label for="budgetMensuel" class="block text-sm font-medium text-gray-700">Budget mensuel envisagé</label>
                            <select id="budgetMensuel" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                                <option value="">Sélectionnez</option>
                                <option value="500">Moins de 500€</option>
                                <option value="500-1000">500€ - 1000€</option>
                                <option value="1000-2000">1000€ - 2000€</option>
                                <option value="2000-5000">2000€ - 5000€</option>
                                <option value="5000+">Plus de 5000€</option>
                                <option value="negocier">À négocier</option>
                            </select>
                        </div>

                        <div>
                            <label for="budgetPublicite" class="block text-sm font-medium text-gray-700">Budget publicité mensuel</label>
                            <select id="budgetPublicite" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                                <option value="">Sélectionnez</option>
                                <option value="0">Pas de publicité</option>
                                <option value="100">100€ - 300€</option>
                                <option value="300-500">300€ - 500€</option>
                                <option value="500-1000">500€ - 1000€</option>
                                <option value="1000+">Plus de 1000€</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Services inclus souhaités</label>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="checkbox" id="creationContenu" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Création de contenu</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="planification" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Planification des publications</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="rapportsStats" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Rapports et statistiques</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="formationEquipe" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Formation de l'équipe</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="strategieContenu" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Élaboration de stratégie</span>
                                </label>
                            </div>
                        </div>

                        <div>
                            <label for="dureeCollaboration" class="block text-sm font-medium text-gray-700">Durée de collaboration envisagée</label>
                            <select id="dureeCollaboration" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                                <option value="">Sélectionnez</option>
                                <option value="3mois">3 mois</option>
                                <option value="6mois">6 mois</option>
                                <option value="12mois">12 mois</option>
                                <option value="longue">Long terme (sans limite)</option>
                                <option value="ponctuel">Mission ponctuelle</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Commentaire d'étape -->
                    <div class="mt-6 border-t pt-4">
                        <div class="flex items-center justify-between mb-2">
                            <label for="commentaireBudgetRessources" class="block text-sm font-medium text-gray-700">Commentaire</label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="requireCommentBudgetRessources" class="h-4 w-4 text-puy-orange rounded border-gray-300">
                                <span class="text-sm text-gray-600">Commentaire requis</span>
                            </label>
                        </div>
                        <textarea id="commentaireBudgetRessources" rows="3" placeholder="Notes sur le budget et ressources..." class="block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm"></textarea>
                        <div id="errorBudgetRessources" class="hidden mt-2 text-sm text-red-600"></div>
                    </div>
                </div>

                <!-- Étape 7: Mesure et analyse -->
                <div class="step-content" data-step="7">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">7. Mesure et analyse</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">KPI prioritaires</label>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="checkbox" id="nombreAbonnes" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Nombre d'abonnés</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="tauxEngagement" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Taux d'engagement</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="porteePublications" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Portée des publications</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="clicsLiens" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Clics sur liens</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="conversions" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Conversions/Ventes</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="mentionsMarque" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Mentions de la marque</span>
                                </label>
                            </div>
                        </div>

                        <div>
                            <label for="frequenceRapports" class="block text-sm font-medium text-gray-700">Fréquence des rapports souhaitée</label>
                            <select id="frequenceRapports" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                                <option value="">Sélectionnez</option>
                                <option value="hebdomadaire">Hebdomadaire</option>
                                <option value="mensuel">Mensuelle</option>
                                <option value="trimestriel">Trimestrielle</option>
                                <option value="semestriel">Semestrielle</option>
                            </select>
                        </div>

                        <div>
                            <label for="outilsAnalyse" class="block text-sm font-medium text-gray-700">Outils d'analyse actuellement utilisés</label>
                            <input type="text" id="outilsAnalyse" placeholder="Google Analytics, Facebook Insights, autres..." class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                        </div>

                        <div>
                            <label for="objectifsChiffres" class="block text-sm font-medium text-gray-700">Objectifs chiffrés (si applicable)</label>
                            <textarea id="objectifsChiffres" rows="3" placeholder="Ex: +500 abonnés par mois, +20% d'engagement..." class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm"></textarea>
                        </div>
                    </div>
                    
                    <!-- Commentaire d'étape -->
                    <div class="mt-6 border-t pt-4">
                        <div class="flex items-center justify-between mb-2">
                            <label for="commentaireMesureAnalyse" class="block text-sm font-medium text-gray-700">Commentaire</label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="requireCommentMesureAnalyse" class="h-4 w-4 text-puy-orange rounded border-gray-300">
                                <span class="text-sm text-gray-600">Commentaire requis</span>
                            </label>
                        </div>
                        <textarea id="commentaireMesureAnalyse" rows="3" placeholder="Notes sur la mesure et analyse..." class="block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm"></textarea>
                        <div id="errorMesureAnalyse" class="hidden mt-2 text-sm text-red-600"></div>
                    </div>
                </div>

                <!-- Étape 8: Organisation et collaboration -->
                <div class="step-content" data-step="8">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">8. Organisation et collaboration</h3>
                    <div class="space-y-4">
                        <div>
                            <label for="personneReferente" class="block text-sm font-medium text-gray-700">Personne référente côté client</label>
                            <input type="text" id="personneReferente" placeholder="Nom et fonction" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                        </div>

                        <div>
                            <label for="processusValidation" class="block text-sm font-medium text-gray-700">Processus de validation souhaité</label>
                            <select id="processusValidation" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                                <option value="">Sélectionnez</option>
                                <option value="validation-prealable">Validation préalable de tous les contenus</option>
                                <option value="validation-partielle">Validation sur certains contenus seulement</option>
                                <option value="autonomie-complete">Autonomie complète de l'agence</option>
                                <option value="validation-posteriori">Validation a posteriori</option>
                            </select>
                        </div>

                        <div>
                            <label for="delaisValidation" class="block text-sm font-medium text-gray-700">Délais de validation</label>
                            <select id="delaisValidation" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                                <option value="">Sélectionnez</option>
                                <option value="24h">24 heures</option>
                                <option value="48h">48 heures</option>
                                <option value="72h">72 heures</option>
                                <option value="1-semaine">1 semaine</option>
                            </select>
                        </div>

                        <div>
                            <label for="outilsCommunication" class="block text-sm font-medium text-gray-700">Outils de communication préférés</label>
                            <div class="grid grid-cols-2 gap-3 mt-2">
                                <label class="flex items-center">
                                    <input type="checkbox" id="email" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Email</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="whatsapp" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">WhatsApp</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="slack" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Slack</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="teams" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Microsoft Teams</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="reunions" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Réunions régulières</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="telephone" class="rounded border-gray-300 text-puy-orange focus:ring-puy-orange">
                                    <span class="ml-2 text-sm text-gray-700">Téléphone</span>
                                </label>
                            </div>
                        </div>

                        <div>
                            <label for="frequenceRDV" class="block text-sm font-medium text-gray-700">Fréquence des points souhaités</label>
                            <select id="frequenceRDV" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm">
                                <option value="">Sélectionnez</option>
                                <option value="hebdomadaire">Hebdomadaire</option>
                                <option value="bi-mensuel">Bi-mensuel</option>
                                <option value="mensuel">Mensuel</option>
                                <option value="trimestriel">Trimestriel</option>
                                <option value="besoin">Selon les besoins</option>
                            </select>
                        </div>

                        <div>
                            <label for="commentairesFinaux" class="block text-sm font-medium text-gray-700">Commentaires additionnels</label>
                            <textarea id="commentairesFinaux" rows="4" placeholder="Précisions, attentes particulières, contraintes..." class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm"></textarea>
                        </div>
                    </div>
                    
                    <!-- Commentaire d'étape -->
                    <div class="mt-6 border-t pt-4">
                        <div class="flex items-center justify-between mb-2">
                            <label for="commentaireOrganisationCollaboration" class="block text-sm font-medium text-gray-700">Commentaire</label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="requireCommentOrganisationCollaboration" class="h-4 w-4 text-puy-orange rounded border-gray-300">
                                <span class="text-sm text-gray-600">Commentaire requis</span>
                            </label>
                        </div>
                        <textarea id="commentaireOrganisationCollaboration" rows="3" placeholder="Notes sur l'organisation et collaboration..." class="block w-full rounded-md border-gray-300 shadow-sm focus:border-puy-orange focus:ring-puy-orange sm:text-sm"></textarea>
                        <div id="errorOrganisationCollaboration" class="hidden mt-2 text-sm text-red-600"></div>
                    </div>
                </div>
            </div>

            <!-- Actions sticky -->
            <div class="sticky bottom-0 bg-white border-t border-gray-200 shadow-lg no-print">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                    <div class="flex flex-wrap gap-3 justify-center">
                        <button id="previewButton" class="inline-flex items-center px-4 py-2 border border-puy-orange text-puy-orange bg-white hover:bg-puy-orange hover:text-white rounded-md transition-colors">
                            <svg id="previewIcon" class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                            </svg>
                            <span id="previewText">Prévisualiser l'audit</span>
                        </button>
                        <button id="pdfPreviewButton" class="inline-flex items-center px-4 py-2 border border-green-600 text-green-600 bg-white hover:bg-green-600 hover:text-white rounded-md transition-colors">
                            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7h4m0 0v4m0-4l-6 6"/>
                            </svg>
                            Aperçu PDF
                        </button>
                        <button id="exportJsonButton" class="inline-flex items-center px-4 py-2 border border-blue-600 text-blue-600 bg-white hover:bg-blue-600 hover:text-white rounded-md transition-colors">
                            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3M3 17V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"/>
                            </svg>
                            Exporter JSON
                        </button>
                        <button id="saveDraftButton" class="inline-flex items-center px-4 py-2 border border-green-600 text-green-600 bg-white hover:bg-green-600 hover:text-white rounded-md transition-colors">
                            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"/>
                            </svg>
                            Sauvegarder
                        </button>
                        <button id="exportPdfButton" class="inline-flex items-center px-4 py-2 bg-puy-orange text-white hover:bg-puy-red rounded-md transition-colors shadow-lg">
                            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a1 1 0 00-.293-.707L16 5.586A1 1 0 0015.586 5H4a2 2 0 00-2 2v10a2 2 0 002 2h2"/>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.5 7.5l3 3m0 0l3-3m-3 3v12"/>
                            </svg>
                            Exporter PDF
                        </button>
                        <button id="sendEmailButton" class="inline-flex items-center px-4 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-md transition-colors shadow-lg">
                            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                            </svg>
                            Envoyer par email
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Configuration Supabase
        const SUPABASE_URL = 'https://ltqkbtfdjvslqktjtbod.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx0cWtidGZkanZzbHFrdGp0Ym9kIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY4MjE1NzgsImV4cCI6MjA3MjM5NzU3OH0.RnZQZ3QmYrcedLK-IefXCQhTeNFJOUNmU7O0f5HGkLg';
        
        const { createClient } = supabase;
        const supabaseClient = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Vérifier l'authentification
        async function checkAuth() {
            const { data: { session } } = await supabaseClient.auth.getSession();
            if (!session) {
                window.location.href = './index.html';
                return false;
            }
            
            return true;
        }

        // Déconnexion
        document.getElementById('logoutButton').addEventListener('click', async () => {
            await supabaseClient.auth.signOut();
            window.location.href = './index.html';
        });

        // Variables globales
        let currentStep = 1;
        const maxSteps = 8;
        const steps = [
            { id: 1, title: "Informations générales" },
            { id: 2, title: "Présence digitale actuelle" },
            { id: 3, title: "Objectifs et cibles" },
            { id: 4, title: "Stratégie de contenu" },
            { id: 5, title: "Engagement et animation" },
            { id: 6, title: "Budget et ressources" },
            { id: 7, title: "Mesure et analyse" },
            { id: 8, title: "Organisation et collaboration" }
        ];

        // Initialisation
        function init() {
            loadFromLocalStorage();
            updateStepDisplay();
            bindEvents();
        }

        // Mise à jour de l'affichage du step
        function updateStepDisplay() {
            document.getElementById('stepIndicator').textContent = currentStep;
            document.getElementById('stepTitle').textContent = steps[currentStep - 1].title;
            document.getElementById('currentStep').textContent = currentStep;
            document.getElementById('progressBar').style.width = `${(currentStep / maxSteps) * 100}%`;
            
            // Afficher/masquer les étapes
            document.querySelectorAll('.step-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelector(`[data-step="${currentStep}"]`).classList.add('active');
            
            // Boutons navigation
            document.getElementById('prevButton').disabled = currentStep === 1;
            document.getElementById('nextButton').textContent = currentStep === maxSteps ? 'Terminer' : 'Suivant';
        }

        // Navigation
        function goToStep(step) {
            if (step < 1 || step > maxSteps) return;
            
            // Valider l'étape actuelle avant de naviguer
            if (!validateCurrentStep()) return;
            
            currentStep = step;
            updateStepDisplay();
        }

        // Validation de l'étape courante
        function validateCurrentStep() {
            return true; // Pas de validation obligatoire
        }

        // Gestion des événements
        function bindEvents() {
            // Navigation
            document.getElementById('nextButton').addEventListener('click', () => {
                if (currentStep < maxSteps) {
                    goToStep(currentStep + 1);
                } else {
                    // Terminer - aller à la prévisualisation
                    if (document.getElementById('previewSection').classList.contains('hidden')) {
                        togglePreview();
                    }
                }
            });
            
            document.getElementById('prevButton').addEventListener('click', () => {
                goToStep(currentStep - 1);
            });
            
            // Navigation clavier
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowRight' && !e.target.matches('input, textarea, select')) {
                    goToStep(currentStep + 1);
                } else if (e.key === 'ArrowLeft' && !e.target.matches('input, textarea, select')) {
                    goToStep(currentStep - 1);
                }
            });
            
            // Actions principales
            document.getElementById('previewButton').addEventListener('click', togglePreview);
            document.getElementById('pdfPreviewButton').addEventListener('click', showPdfPreview);
            document.getElementById('exportJsonButton').addEventListener('click', exportJson);
            document.getElementById('saveDraftButton').addEventListener('click', saveDraft);
            document.getElementById('exportPdfButton').addEventListener('click', exportPdf);
            document.getElementById('sendEmailButton').addEventListener('click', sendByEmail);
            
            // Sauvegarder automatiquement
            setInterval(saveToLocalStorage, 30000);
            
            // Sauvegarder au changement de valeur
            document.addEventListener('input', saveToLocalStorage);
            document.addEventListener('change', saveToLocalStorage);
        }

        // Collecte toutes les données du formulaire
        function collectAllData() {
            return {
                informations_generales: {
                    entreprise: document.getElementById('entreprise')?.value || '',
                    secteur: document.getElementById('secteur')?.value || '',
                    nom_prenom: document.getElementById('nomPrenom')?.value || '',
                    email: document.getElementById('email')?.value || '',
                    telephone: document.getElementById('telephone')?.value || '',
                    taille_entreprise: document.getElementById('tailleEntreprise')?.value || ''
                },
                presence_digitale: {
                    site_web: document.getElementById('siteWeb')?.value || '',
                    reseaux_sociaux: {
                        facebook: document.getElementById('facebook')?.checked || false,
                        instagram: document.getElementById('instagram')?.checked || false,
                        linkedin: document.getElementById('linkedin')?.checked || false,
                        twitter: document.getElementById('twitter')?.checked || false,
                        tiktok: document.getElementById('tiktok')?.checked || false,
                        youtube: document.getElementById('youtube')?.checked || false
                    },
                    frequence_publication: document.getElementById('frequencePublication')?.value || '',
                    gestion_actuelle: document.getElementById('gestionActuelle')?.value || ''
                },
                objectifs_cibles: {
                    objectifs: {
                        notoriete: document.getElementById('notoriete')?.checked || false,
                        engagement: document.getElementById('engagement')?.checked || false,
                        ventes: document.getElementById('ventes')?.checked || false,
                        leads: document.getElementById('leads')?.checked || false,
                        trafic: document.getElementById('trafic')?.checked || false,
                        fidelisation: document.getElementById('fidelisation')?.checked || false
                    },
                    cible_age: document.getElementById('cibleAge')?.value || '',
                    cible_description: document.getElementById('cibleDescription')?.value || '',
                    concurrents: document.getElementById('concurrents')?.value || ''
                },
                strategie_contenu: {
                    types_contenus: {
                        photos: document.getElementById('photos')?.checked || false,
                        videos: document.getElementById('videos')?.checked || false,
                        articles: document.getElementById('articles')?.checked || false,
                        temoignages: document.getElementById('temoignages')?.checked || false,
                        promotions: document.getElementById('promotions')?.checked || false,
                        evenements: document.getElementById('evenements')?.checked || false
                    },
                    tonalite: document.getElementById('tonalite')?.value || '',
                    sujets_interets: document.getElementById('sujetsInterets')?.value || '',
                    ressources_contenu: document.getElementById('ressourcesContenu')?.value || ''
                },
                engagement_animation: {
                    frequence_souhaitee: document.getElementById('frequenceSouhaitee')?.value || '',
                    services_animation: {
                        reponse_commentaires: document.getElementById('reponseCommentaires')?.checked || false,
                        reponse_messages: document.getElementById('reponseMessages')?.checked || false,
                        moderation: document.getElementById('moderation')?.checked || false,
                        concours: document.getElementById('concours')?.checked || false,
                        stories: document.getElementById('stories')?.checked || false
                    },
                    heures_publication: document.getElementById('heuresPublication')?.value || '',
                    gestion_crise: document.getElementById('gestionCrise')?.value || ''
                },
                budget_ressources: {
                    budget_mensuel: document.getElementById('budgetMensuel')?.value || '',
                    budget_publicite: document.getElementById('budgetPublicite')?.value || '',
                    services_inclus: {
                        creation_contenu: document.getElementById('creationContenu')?.checked || false,
                        planification: document.getElementById('planification')?.checked || false,
                        rapports_stats: document.getElementById('rapportsStats')?.checked || false,
                        formation_equipe: document.getElementById('formationEquipe')?.checked || false,
                        strategie_contenu: document.getElementById('strategieContenu')?.checked || false
                    },
                    duree_collaboration: document.getElementById('dureeCollaboration')?.value || ''
                },
                mesure_analyse: {
                    kpi_prioritaires: {
                        nombre_abonnes: document.getElementById('nombreAbonnes')?.checked || false,
                        taux_engagement: document.getElementById('tauxEngagement')?.checked || false,
                        portee_publications: document.getElementById('porteePublications')?.checked || false,
                        clics_liens: document.getElementById('clicsLiens')?.checked || false,
                        conversions: document.getElementById('conversions')?.checked || false,
                        mentions_marque: document.getElementById('mentionsMarque')?.checked || false
                    },
                    frequence_rapports: document.getElementById('frequenceRapports')?.value || '',
                    outils_analyse: document.getElementById('outilsAnalyse')?.value || '',
                    objectifs_chiffres: document.getElementById('objectifsChiffres')?.value || ''
                },
                organisation_collaboration: {
                    personne_referente: document.getElementById('personneReferente')?.value || '',
                    processus_validation: document.getElementById('processusValidation')?.value || '',
                    delais_validation: document.getElementById('delaisValidation')?.value || '',
                    outils_communication: {
                        email: document.getElementById('email')?.checked || false,
                        whatsapp: document.getElementById('whatsapp')?.checked || false,
                        slack: document.getElementById('slack')?.checked || false,
                        teams: document.getElementById('teams')?.checked || false,
                        reunions: document.getElementById('reunions')?.checked || false,
                        telephone: document.getElementById('telephone')?.checked || false
                    },
                    frequence_rdv: document.getElementById('frequenceRDV')?.value || '',
                    commentaires_finaux: document.getElementById('commentairesFinaux')?.value || ''
                }
            };
        }

        // Sauvegarder dans le localStorage
        function saveToLocalStorage() {
            const data = collectAllData();
            localStorage.setItem('analyse360_cm', JSON.stringify(data));
        }

        // Charger depuis le localStorage
        function loadFromLocalStorage() {
            const saved = localStorage.getItem('analyse360_cm');
            if (!saved) return;
            
            try {
                const data = JSON.parse(saved);
                populateForm(data);
            } catch (e) {
                console.error('Erreur lors du chargement des données sauvegardées:', e);
            }
        }

        // Remplir le formulaire avec les données
        function populateForm(data) {
            // Helper pour remplir les champs
            function setField(id, value) {
                const field = document.getElementById(id);
                if (field) {
                    if (field.type === 'checkbox') {
                        field.checked = value;
                    } else {
                        field.value = value;
                    }
                }
            }

            // Informations générales
            if (data.informations_generales) {
                setField('entreprise', data.informations_generales.entreprise);
                setField('secteur', data.informations_generales.secteur);
                setField('nomPrenom', data.informations_generales.nom_prenom);
                setField('email', data.informations_generales.email);
                setField('telephone', data.informations_generales.telephone);
                setField('tailleEntreprise', data.informations_generales.taille_entreprise);
            }

            // Présence digitale
            if (data.presence_digitale) {
                setField('siteWeb', data.presence_digitale.site_web);
                setField('frequencePublication', data.presence_digitale.frequence_publication);
                setField('gestionActuelle', data.presence_digitale.gestion_actuelle);
                
                if (data.presence_digitale.reseaux_sociaux) {
                    Object.keys(data.presence_digitale.reseaux_sociaux).forEach(key => {
                        setField(key, data.presence_digitale.reseaux_sociaux[key]);
                    });
                }
            }

            // Continue for other sections...
        }

        // Export PDF
        function exportPdf() {
            const data = collectAllData();
            const date = new Date().toLocaleDateString('fr-FR', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            // Créer le contenu professionnel du PDF
            const pdfContent = generateProfessionalPDF(data, date);
            
            // Masquer le contenu normal et afficher le contenu d'impression
            const originalContent = document.body.innerHTML;
            document.body.innerHTML = pdfContent;
            
            setTimeout(() => {
                window.print();
                // Restaurer le contenu original
                setTimeout(() => {
                    document.body.innerHTML = originalContent;
                    // Rebind les événements
                    init();
                }, 1000);
            }, 500);
        }

        function generateProfessionalPDF(data, date) {
            const clientName = data.informations_generales?.entreprise || data.informations_generales?.nom_prenom || 'Client';
            
            return `
                <!-- Page de couverture -->
                <div class="cover-page">
                    <div style="margin-bottom: 3rem;">
                        <img src="https://puydecom.fr/images/Logo-Puy-De-Com.jpeg" alt="PuyDeCom" style="width: 150px; height: 150px; margin: 0 auto 2rem auto; border-radius: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
                    </div>
                    <h1 style="font-size: 36pt; font-weight: bold; color: #1F2937; margin-bottom: 1rem;">AUDIT DE BESOINS</h1>
                    <h2 style="font-size: 24pt; color: #10B981; margin-bottom: 2rem;">Community Management</h2>
                    <div style="margin-bottom: 3rem;">
                        <p style="font-size: 18pt; color: #374151; margin-bottom: 0.5rem;">Client : ${clientName}</p>
                        <p style="font-size: 14pt; color: #6B7280;">Établi le ${date}</p>
                    </div>
                    <div style="margin-top: auto; padding-top: 4rem;">
                        <p style="font-size: 14pt; color: #374151;">PuyDeCom</p>
                        <p style="font-size: 12pt; color: #6B7280;">Agence de Communication Digitale</p>
                    </div>
                </div>

                <!-- Table des matières -->
                <div class="toc-page">
                    <h1 style="font-size: 24pt; font-weight: bold; color: #1F2937; margin-bottom: 2rem; border-bottom: 2px solid #10B981; padding-bottom: 0.5rem;">TABLE DES MATIÈRES</h1>
                    <div class="toc-item"><span>1. Informations Générales</span><span>3</span></div>
                    <div class="toc-item"><span>2. Présence Digitale Actuelle</span><span>4</span></div>
                    <div class="toc-item"><span>3. Objectifs et Cibles</span><span>5</span></div>
                    <div class="toc-item"><span>4. Stratégie de Contenu</span><span>6</span></div>
                    <div class="toc-item"><span>5. Engagement et Animation</span><span>7</span></div>
                    <div class="toc-item"><span>6. Budget et Ressources</span><span>8</span></div>
                    <div class="toc-item"><span>7. Mesure et Analyse</span><span>9</span></div>
                    <div class="toc-item"><span>8. Organisation et Collaboration</span><span>10</span></div>
                    <div class="toc-item"><span>9. Signatures</span><span>11</span></div>
                </div>

                <!-- Chapitres -->
                ${generateChapter(1, "Informations Générales", data.informations_generales)}
                ${generateChapter(2, "Présence Digitale Actuelle", data.presence_digitale)}
                ${generateChapter(3, "Objectifs et Cibles", data.objectifs_cibles)}
                ${generateChapter(4, "Stratégie de Contenu", data.strategie_contenu)}
                ${generateChapter(5, "Engagement et Animation", data.engagement_animation)}
                ${generateChapter(6, "Budget et Ressources", data.budget_ressources)}
                ${generateChapter(7, "Mesure et Analyse", data.mesure_analyse)}
                ${generateChapter(8, "Organisation et Collaboration", data.organisation_collaboration)}
                
                <!-- Page de signatures -->
                <div class="signatures-print">
                    <h1 class="chapter-title"><span class="chapter-number">9.</span> SIGNATURES</h1>
                    <p style="margin-bottom: 2rem; font-style: italic;">Cet audit de besoins a été établi d'un commun accord entre les parties. Les signatures ci-dessous valident l'acceptation des termes et conditions définis dans ce document.</p>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; margin-top: 3rem;">
                        <div class="signature-box avoid-break">
                            <h3 style="font-weight: bold; margin-bottom: 1rem;">CLIENT</h3>
                            <div style="height: 100px; border-bottom: 2px solid #333; margin-bottom: 1rem;"></div>
                            <p><strong>Nom :</strong> ${clientName}</p>
                            <p><strong>Fonction :</strong> _________________</p>
                            <p><strong>Date :</strong> ___________________</p>
                            <p style="margin-top: 0.5rem; font-size: 9pt; color: #666;">Signature précédée de "Lu et approuvé"</p>
                        </div>
                        <div class="signature-box avoid-break">
                            <h3 style="font-weight: bold; margin-bottom: 1rem;">PUYDECOM</h3>
                            <div style="height: 100px; border-bottom: 2px solid #333; margin-bottom: 1rem;"></div>
                            <p><strong>Nom :</strong> _________________</p>
                            <p><strong>Fonction :</strong> Community Manager</p>
                            <p><strong>Date :</strong> ___________________</p>
                            <p style="margin-top: 0.5rem; font-size: 9pt; color: #666;">Signature précédée de "Bon pour accord"</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateChapter(number, title, sectionData) {
            if (!sectionData) return '';
            
            let content = `
                <div class="chapter">
                    <h1 class="chapter-title"><span class="chapter-number">${number}.</span> ${title.toUpperCase()}</h1>
            `;
            
            // Générer le contenu selon le type de section
            Object.keys(sectionData).forEach(key => {
                if (sectionData[key]) {
                    const fieldName = key.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                    const value = sectionData[key];
                    
                    if (Array.isArray(value)) {
                        content += `
                            <div class="section avoid-break">
                                <h3 class="section-title">${fieldName}</h3>
                                <div class="section-content">
                                    <ul>
                                        ${value.map(item => `<li>${item}</li>`).join('')}
                                    </ul>
                                </div>
                            </div>
                        `;
                    } else if (typeof value === 'object') {
                        content += `
                            <div class="section avoid-break">
                                <h3 class="section-title">${fieldName}</h3>
                                <div class="section-content">
                                    ${Object.keys(value).map(subKey => 
                                        `<p><strong>${subKey.replace(/_/g, ' ')}:</strong> ${value[subKey]}</p>`
                                    ).join('')}
                                </div>
                            </div>
                        `;
                    } else {
                        content += `
                            <div class="section avoid-break">
                                <h3 class="section-title">${fieldName}</h3>
                                <div class="section-content">
                                    <p>${value}</p>
                                </div>
                            </div>
                        `;
                    }
                }
            });
            
            content += '</div>';
            return content;
        }

        function showPdfPreview() {
            const data = collectAllData();
            const date = new Date().toLocaleDateString('fr-FR', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            // Créer le contenu professionnel du PDF
            const pdfContent = generateProfessionalPDF(data, date);
            
            // Ouvrir dans une nouvelle fenêtre pour prévisualisation
            const previewWindow = window.open('', '_blank', 'width=1200,height=800');
            previewWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Aperçu PDF - Audit Community Management</title>
                    <style>
                        body { 
                            font-family: 'Inter', Arial, sans-serif; 
                            margin: 0; 
                            padding: 20px; 
                            background: #f5f5f5;
                        }
                        .pdf-container {
                            max-width: 210mm;
                            margin: 0 auto;
                            background: white;
                            padding: 20mm;
                            box-shadow: 0 0 20px rgba(0,0,0,0.1);
                        }
                        ${document.querySelector('style').textContent}
                    </style>
                </head>
                <body>
                    <div class="pdf-container">
                        ${pdfContent}
                    </div>
                    <div style="text-align: center; margin: 20px;">
                        <button onclick="window.print()" style="padding: 10px 20px; background: #10B981; color: white; border: none; border-radius: 5px; cursor: pointer;">Imprimer le PDF</button>
                        <button onclick="window.close()" style="padding: 10px 20px; background: #6B7280; color: white; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px;">Fermer</button>
                    </div>
                </body>
                </html>
            `);
            previewWindow.document.close();
        }

        // Autres fonctions utilitaires (exportJson, saveDraft, sendByEmail, togglePreview, etc.)
        function exportJson() {
            const data = {
                analyse360_cm: collectAllData()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'analyse360-cm.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('Export JSON réussi !', 'success');
        }

        function saveDraft() {
            saveToLocalStorage();
            showNotification('Brouillon sauvegardé !', 'success');
        }

        function sendByEmail() {
            const data = collectAllData();
            const clientEmail = data.informations_generales.email;
            const raisonSociale = data.informations_generales.entreprise || 'Client';
            
            const subject = encodeURIComponent(`Audit Community Management - ${raisonSociale}`);
            const body = encodeURIComponent(`Bonjour,

Veuillez trouver en pièce jointe l'audit de besoins pour votre projet de community management.

Ce document reprend l'ensemble des éléments que nous avons définis ensemble lors de notre analyse.

N'hésitez pas à me contacter pour toute question ou modification.

Cordialement,
L'équipe PuyDeCom`);
            
            if (clientEmail) {
                window.open(`mailto:${clientEmail}?subject=${subject}&body=${body}`, '_blank');
            } else {
                window.open(`mailto:?subject=${subject}&body=${body}`, '_blank');
            }
        }

        function togglePreview() {
            // Implementation for preview toggle
            showNotification('Prévisualisation activée', 'info');
        }

        function showNotification(message, type) {
            // Simple notification system
            console.log(`${type.toUpperCase()}: ${message}`);
        }

        // Initialisation au chargement de la page
        checkAuth().then(authenticated => {
            if (authenticated) {
                init();
            }
        });
    </script>
</body>
</html>